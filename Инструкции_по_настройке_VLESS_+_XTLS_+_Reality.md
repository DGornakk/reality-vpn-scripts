# Инструкции по настройке VLESS + XTLS + Reality

## 1. Настройка сервера (Debian)

1.  **Подключитесь к вашему Debian серверу по SSH.**

2.  **Загрузите скрипт установки:**

    ```bash
    wget https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/install_reality.sh
    ```
    *(Примечание: Вам нужно будет разместить `install_reality.sh` на своем GitHub или другом доступном ресурсе, или скопировать его вручную на сервер.)*

3.  **Сделайте скрипт исполняемым:**

    ```bash
    chmod +x install_reality.sh
    ```

4.  **Запустите скрипт от имени root:**

    ```bash
    sudo ./install_reality.sh
    ```

    Скрипт автоматически установит Xray-core, сгенерирует необходимые ключи для Reality и создаст конфигурационный файл `/etc/xray/config.json`. В качестве домена для маскировки будет использоваться `dl.google.com`.

5.  **Получите данные для клиентской конфигурации:**

    После завершения работы скрипта, ваши приватный ключ, публичный ключ и ShortId будут сохранены в файле `/etc/xray/reality_keys.env`.

    ```bash
    sudo cat /etc/xray/reality_keys.env
    ```

    Вывод будет примерно таким:

    ```
    PRIVATE_KEY=ваш_приватный_ключ
    PUBLIC_KEY=ваш_публичный_ключ
    SHORT_ID=ваш_short_id
    ```

## 2. Управление пользователями и генерация клиентских конфигов

Для добавления новых пользователей и генерации клиентских конфигураций используйте скрипт `manage_users.sh`.

1.  **Загрузите скрипт управления пользователями:**

    ```bash
    wget https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/manage_users.sh
    ```
    *(Примечание: Вам нужно будет разместить `manage_users.sh` на своем GitHub или другом доступном ресурсе, или скопировать его вручную на сервер.)*

2.  **Сделайте скрипт исполняемым:**

    ```bash
    chmod +x manage_users.sh
    ```

3.  **Добавление нового пользователя и генерация конфига:**

    ```bash
    sudo ./manage_users.sh add
    ```
    Скрипт запросит имя пользователя, сгенерирует для него UUID, добавит его в конфигурацию Xray и создаст файл `[имя_пользователя]_client_config.json` с готовой клиентской конфигурацией в текущей директории.

4.  **Генерация конфига для существующего пользователя (если вы потеряли файл):**

    ```bash
    sudo ./manage_users.sh generate
    ```
    Скрипт запросит UUID и имя пользователя, а затем сгенерирует файл `[имя_пользователя]_client_config.json`.

## 3. Настройка клиента (Xray-core)

Для настройки клиента вам понадобится `Xray-core` на вашем устройстве (Windows, macOS, Linux, Android, iOS). Используйте сгенерированный файл `[имя_пользователя]_client_config.json`.

Пример содержимого файла `[имя_пользователя]_client_config.json`:

```json
{
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "ВАШ_IP_СЕРВЕРА",
            "port": 443,
            "users": [
              {
                "id": "ВАШ_UUID_С_СЕРВЕРА",
                "flow": "xtls-rprx-vision",
                "encryption": "none"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "raw",
        "security": "reality",
        "realitySettings": {
          "show": false,
          "fingerprint": "chrome",
          "serverName": "dl.google.com",
          "publicKey": "ВАШ_ПУБЛИЧНЫЙ_КЛЮЧ_С_СЕРВЕРА",
          "shortId": "ВАШ_SHORT_ID_С_СЕРВЕРА",
          "spiderX": "/" 
        }
      }
    }
  ]
}
```

**Важные замечания:**

*   **`ВАШ_IP_СЕРВЕРА`**: IP-адрес вашего сервера. Скрипт `manage_users.sh` автоматически подставит его в генерируемый конфиг.
*   **`ВАШ_UUID_С_СЕРВЕРА`**: UUID, который был сгенерирован для конкретного пользователя.
*   **`ВАШ_ПУБЛИЧНЫЙ_КЛЮЧ_С_СЕРВЕРА`**: Публичный ключ, который был сгенерирован скриптом `install_reality.sh` и находится в `/etc/xray/reality_keys.env`.
*   **`ВАШ_SHORT_ID_С_СЕРВЕРА`**: ShortId, который был сгенерирован скриптом `install_reality.sh` и находится в `/etc/xray/reality_keys.env`.

## 4. Дополнительные рекомендации

*   **Фаервол**: Убедитесь, что порт 443 открыт на вашем сервере.
*   **Обновление Xray**: Регулярно обновляйте Xray-core на сервере и клиенте для получения последних исправлений и улучшений.

